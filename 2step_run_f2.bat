@echo off
Title Simple Setup for In-House Program
:: ‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå Administrator ‡∏ô‡∏∞‡∏Ñ‡∏£‡∏±‡∏ö‡∏õ‡πã‡∏≤

:: =========================================================
:: üì£ ‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡πã‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ (‡πÅ‡∏Å‡πâ‡πÅ‡∏Ñ‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡∏Å‡∏±‡∏ö‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå)
:: =========================================================

:: 1. ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÉ‡∏ô ProgramData (‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡πä‡∏≠‡∏õ‡πÉ‡∏´‡∏°‡πà)
set "DATA_FOLDER_NAME=‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡∏≠‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏¥‡∏ô‡πÄ‡∏Æ‡πâ‡∏≤‡∏™‡πå"

:: 2. ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ô USB
set "USB_SOURCE_PATH=E:\‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ôUSB"

:: 3. ‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤ Desktop (‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ .lnk ‡∏ï‡πà‡∏≠‡∏ó‡πâ‡∏≤‡∏¢)
set "DESKTOP_ICON_NAME=‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏¥‡∏ô‡πÄ‡∏Æ‡πâ‡∏≤‡∏™‡πå.lnk"

:: 4. ‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡πÑ‡∏ü‡∏•‡πå EXE (‡πÄ‡∏≠‡∏≤‡πÑ‡∏ß‡πâ‡∏™‡∏±‡πà‡∏á Run ‡∏ï‡∏≠‡∏ô‡∏à‡∏ö)
set "PROGRAM_EXE_PATH=C:\Program Files\‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏¥‡∏ô‡πÄ‡∏Æ‡πâ‡∏≤‡∏™‡πå\‡∏ï‡∏±‡∏ß‡∏£‡∏±‡∏ô‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏≠‡∏¥‡∏ô‡πÄ‡∏Æ‡πâ‡∏≤‡∏™‡πå.exe"

:: =========================================================
:: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô
:: =========================================================

echo.
echo [1/4] ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏Å‡πà‡∏≤‡πÉ‡∏ô ProgramData...
if exist "%ProgramData%\%DATA_FOLDER_NAME%" (
    rd /s /q "%ProgramData%\%DATA_FOLDER_NAME%"
)

echo.
echo [2/4] ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà‡∏à‡∏≤‡∏Å USB...
robocopy "%USB_SOURCE_PATH%" "%ProgramData%\%DATA_FOLDER_NAME%" /E /V /R:0 /W:0 >nul

echo.
echo [3/4] ‡∏Å‡πä‡∏≠‡∏õ‡∏õ‡∏µ‡πâ‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÑ‡∏õ‡πÉ‡∏™‡πà Startup...
:: ‡∏Å‡πä‡∏≠‡∏õ‡∏à‡∏≤‡∏Å Public Desktop (‡∏ó‡∏µ‡πà‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏™‡πà‡∏ß‡∏ô‡πÉ‡∏´‡∏ç‡πà‡∏°‡∏±‡∏Å‡πÑ‡∏õ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ) ‡πÑ‡∏õ‡πÉ‡∏™‡πà Startup
copy /y "C:\Users\Public\Desktop\%DESKTOP_ICON_NAME%" "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\"

:: ‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏ß‡πà‡∏≤‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡∏π‡πà Public ‡πÅ‡∏ï‡πà‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ User ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
if not exist "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\%DESKTOP_ICON_NAME%" (
    copy /y "%USERPROFILE%\Desktop\%DESKTOP_ICON_NAME%" "%AppData%\Microsoft\Windows\Start Menu\Programs\Startup\"
)

echo.
echo [4/4] ‡πÄ‡∏õ‡∏¥‡∏î‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°...
start "" "%PROGRAM_EXE_PATH%"

echo.
echo ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö‡∏õ‡πã‡∏≤!
pause